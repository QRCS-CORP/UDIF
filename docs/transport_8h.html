<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UDIF: Universal Digital Identification Framework: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/UDIF/UDIF/Saved/transport.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="udif_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">UDIF: Universal Digital Identification Framework<span id="projectnumber">&#160;1.0.0.0a (A1)</span>
   </div>
   <div id="projectbrief">A quantum-secure cryptographic identification</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('transport_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">transport.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>UDIF secure transport layer.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="udif_8h_source.html">udif.h</a>&quot;</code><br />
<code>#include &quot;certificate.h&quot;</code><br />
</div>
<p><a href="transport_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:udif_5Fsession_5Fstate" id="r_udif_5Fsession_5Fstate"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structudif__session__state.html">udif_session_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Secure session state.  <a href="structudif__session__state.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a951a0c785d67eca685d7912c5ba417d1" id="r_a951a0c785d67eca685d7912c5ba417d1"><td class="memItemLeft" align="right" valign="top"><a id="a951a0c785d67eca685d7912c5ba417d1" name="a951a0c785d67eca685d7912c5ba417d1"></a>
typedef <a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> struct udif_session_state&#160;</td><td class="memItemRight" valign="bottom"><b>udif_session_state</b></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a98fd7badff9988dff550464f3bc2f8ee" id="r_a98fd7badff9988dff550464f3bc2f8ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a98fd7badff9988dff550464f3bc2f8ee">udif_session_initialize</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session)</td></tr>
<tr class="memdesc:a98fd7badff9988dff550464f3bc2f8ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a session state.  <br /></td></tr>
<tr class="memitem:abbc426e2bbd31a4d54eaf99f25f002bc" id="r_abbc426e2bbd31a4d54eaf99f25f002bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abbc426e2bbd31a4d54eaf99f25f002bc">udif_session_handshake_init</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session, udif_network_packet *packet, const udif_child_certificate *local_cert, const uint8_t local_privkey[<a class="el" href="udif_8h.html#a063205c071485a302e0899ab8287b5ea">UDIF_ASYMMETRIC_SIGNING_KEY_SIZE</a>], const uint8_t local_serial[UDIF_CERTIFICATE_SERIAL_SIZE], const uint8_t remote_serial[UDIF_CERTIFICATE_SERIAL_SIZE], bool(*rng_generate)(uint8_t *, size_t))</td></tr>
<tr class="memdesc:abbc426e2bbd31a4d54eaf99f25f002bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiator starts handshake.  <br /></td></tr>
<tr class="memitem:aac63643f1e1606c60c2e31972a5b5195" id="r_aac63643f1e1606c60c2e31972a5b5195"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac63643f1e1606c60c2e31972a5b5195">udif_session_handshake_resp</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session, udif_network_packet *packet, const udif_network_packet *init_packet, const udif_child_certificate *local_cert, const uint8_t local_privkey[<a class="el" href="udif_8h.html#a063205c071485a302e0899ab8287b5ea">UDIF_ASYMMETRIC_SIGNING_KEY_SIZE</a>], const uint8_t local_serial[UDIF_CERTIFICATE_SERIAL_SIZE], const udif_child_certificate *remote_cert, bool(*rng_generate)(uint8_t *, size_t))</td></tr>
<tr class="memdesc:aac63643f1e1606c60c2e31972a5b5195"><td class="mdescLeft">&#160;</td><td class="mdescRight">Responder handles handshake init.  <br /></td></tr>
<tr class="memitem:a1ab646085d69be4de25db22247f87d38" id="r_a1ab646085d69be4de25db22247f87d38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ab646085d69be4de25db22247f87d38">udif_session_handshake_confirm</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session, udif_network_packet *packet, const udif_network_packet *resp_packet, const udif_child_certificate *remote_cert)</td></tr>
<tr class="memdesc:a1ab646085d69be4de25db22247f87d38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiator confirms handshake.  <br /></td></tr>
<tr class="memitem:aea32aaf8925357363447569ba14f2b9f" id="r_aea32aaf8925357363447569ba14f2b9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aea32aaf8925357363447569ba14f2b9f">udif_session_handshake_finish</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session, udif_network_packet *packet, const udif_network_packet *confirm_packet)</td></tr>
<tr class="memdesc:aea32aaf8925357363447569ba14f2b9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Responder finishes handshake.  <br /></td></tr>
<tr class="memitem:a7b6cc4eb58f1a8f6d779e62a39462042" id="r_a7b6cc4eb58f1a8f6d779e62a39462042"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b6cc4eb58f1a8f6d779e62a39462042">udif_session_encrypt</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session, udif_network_packet *packet, const uint8_t *plaintext, size_t plntextlen)</td></tr>
<tr class="memdesc:a7b6cc4eb58f1a8f6d779e62a39462042"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a data packet.  <br /></td></tr>
<tr class="memitem:af1fd960e16d86de618a3a7224fbd70c5" id="r_af1fd960e16d86de618a3a7224fbd70c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1fd960e16d86de618a3a7224fbd70c5">udif_session_decrypt</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session, uint8_t *plaintext, size_t *plntextlen, const udif_network_packet *packet)</td></tr>
<tr class="memdesc:af1fd960e16d86de618a3a7224fbd70c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt a data packet.  <br /></td></tr>
<tr class="memitem:ac16ff01596721265c74015fcef49708a" id="r_ac16ff01596721265c74015fcef49708a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac16ff01596721265c74015fcef49708a">udif_session_ratchet</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session, udif_network_packet *packetout, const udif_network_packet *packetin, bool(*rng_generate)(uint8_t *, size_t))</td></tr>
<tr class="memdesc:ac16ff01596721265c74015fcef49708a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform asymmetric ratchet.  <br /></td></tr>
<tr class="memitem:a94dc1f6cf651af7a7f70dde921d8d4ba" id="r_a94dc1f6cf651af7a7f70dde921d8d4ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94dc1f6cf651af7a7f70dde921d8d4ba">udif_session_needs_ratchet</a> (const <a class="el" href="structudif__session__state.html">udif_session_state</a> *session, uint64_t currtime)</td></tr>
<tr class="memdesc:a94dc1f6cf651af7a7f70dde921d8d4ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if ratchet is needed.  <br /></td></tr>
<tr class="memitem:a40491170e4361320d4afce63b9a99d09" id="r_a40491170e4361320d4afce63b9a99d09"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40491170e4361320d4afce63b9a99d09">udif_session_dispose</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session)</td></tr>
<tr class="memdesc:a40491170e4361320d4afce63b9a99d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispose session resources.  <br /></td></tr>
<tr class="memitem:a1f5a207b9ad0af85c40d2457d8d67363" id="r_a1f5a207b9ad0af85c40d2457d8d67363"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f5a207b9ad0af85c40d2457d8d67363">udif_session_clear</a> (<a class="el" href="structudif__session__state.html">udif_session_state</a> *session)</td></tr>
<tr class="memdesc:a1f5a207b9ad0af85c40d2457d8d67363"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear session state.  <br /></td></tr>
<tr class="memitem:a45ecaa01d1d37acb9719813503393fb7" id="r_a45ecaa01d1d37acb9719813503393fb7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45ecaa01d1d37acb9719813503393fb7">udif_session_is_established</a> (const <a class="el" href="structudif__session__state.html">udif_session_state</a> *session)</td></tr>
<tr class="memdesc:a45ecaa01d1d37acb9719813503393fb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if session is established.  <br /></td></tr>
<tr class="memitem:ade1829c128be861719c0c32a5477e2e5" id="r_ade1829c128be861719c0c32a5477e2e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ade1829c128be861719c0c32a5477e2e5">udif_session_get_statistics</a> (const <a class="el" href="structudif__session__state.html">udif_session_state</a> *session, uint64_t *txseq, uint64_t *rxseq, uint64_t *epoch)</td></tr>
<tr class="memdesc:ade1829c128be861719c0c32a5477e2e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get session statistics.  <br /></td></tr>
<tr class="memitem:a489046dfc65bdd7d464a9478a2b3bb47" id="r_a489046dfc65bdd7d464a9478a2b3bb47"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a489046dfc65bdd7d464a9478a2b3bb47">udif_packet_serialize</a> (uint8_t *stream, size_t *streamlen, const udif_network_packet *packet)</td></tr>
<tr class="memdesc:a489046dfc65bdd7d464a9478a2b3bb47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize packet to byte stream.  <br /></td></tr>
<tr class="memitem:a31017ae2370a1894c81b230a85e36013" id="r_a31017ae2370a1894c81b230a85e36013"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a31017ae2370a1894c81b230a85e36013">udif_packet_deserialize</a> (udif_network_packet *packet, const uint8_t *stream, size_t streamlen)</td></tr>
<tr class="memdesc:a31017ae2370a1894c81b230a85e36013"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deserialize packet from byte stream.  <br /></td></tr>
<tr class="memitem:a1d2a438c2a1b200b51ac06fed2a107ba" id="r_a1d2a438c2a1b200b51ac06fed2a107ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d2a438c2a1b200b51ac06fed2a107ba">udif_packet_validate</a> (const <a class="el" href="structudif__session__state.html">udif_session_state</a> *session, const udif_network_packet *packet, uint8_t expected_flag)</td></tr>
<tr class="memdesc:a1d2a438c2a1b200b51ac06fed2a107ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate packet.  <br /></td></tr>
<tr class="memitem:a9657370602c20ea91725f2a50817474c" id="r_a9657370602c20ea91725f2a50817474c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9657370602c20ea91725f2a50817474c">udif_packet_set_time</a> (udif_network_packet *packet, uint64_t currtime)</td></tr>
<tr class="memdesc:a9657370602c20ea91725f2a50817474c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set packet timestamp.  <br /></td></tr>
<tr class="memitem:a05602980776643212a66f4f25167c02d" id="r_a05602980776643212a66f4f25167c02d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a05602980776643212a66f4f25167c02d">udif_packet_is_fresh</a> (const udif_network_packet *packet, uint64_t currtime)</td></tr>
<tr class="memdesc:a05602980776643212a66f4f25167c02d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if packet is fresh.  <br /></td></tr>
<tr class="memitem:a53ffdfdf24b005d4777193e9ab60287c" id="r_a53ffdfdf24b005d4777193e9ab60287c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a53ffdfdf24b005d4777193e9ab60287c">udif_packet_clear</a> (udif_network_packet *packet)</td></tr>
<tr class="memdesc:a53ffdfdf24b005d4777193e9ab60287c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear packet state.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>UDIF secure transport layer. </p>
<p>Provides authenticated encryption for UDIF network communications using ML-KEM key exchange, RCS-256 AEAD, and forward secrecy via asymmetric ratcheting. </p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a53ffdfdf24b005d4777193e9ab60287c" name="a53ffdfdf24b005d4777193e9ab60287c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53ffdfdf24b005d4777193e9ab60287c">&#9670;&#160;</a></span>udif_packet_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void udif_packet_clear </td>
          <td>(</td>
          <td class="paramtype">udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear packet state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>The packet </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a31017ae2370a1894c81b230a85e36013" name="a31017ae2370a1894c81b230a85e36013"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31017ae2370a1894c81b230a85e36013">&#9670;&#160;</a></span>udif_packet_deserialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_packet_deserialize </td>
          <td>(</td>
          <td class="paramtype">udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>stream</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>streamlen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deserialize packet from byte stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>Output packet </td></tr>
    <tr><td class="paramname">stream</td><td>Input byte stream </td></tr>
    <tr><td class="paramname">streamlen</td><td>Stream length </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="a05602980776643212a66f4f25167c02d" name="a05602980776643212a66f4f25167c02d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05602980776643212a66f4f25167c02d">&#9670;&#160;</a></span>udif_packet_is_fresh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool udif_packet_is_fresh </td>
          <td>(</td>
          <td class="paramtype">const udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>currtime</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if packet is fresh. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>The packet </td></tr>
    <tr><td class="paramname">current_time</td><td>Current UTC time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if within time window </dd></dl>

</div>
</div>
<a id="a489046dfc65bdd7d464a9478a2b3bb47" name="a489046dfc65bdd7d464a9478a2b3bb47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a489046dfc65bdd7d464a9478a2b3bb47">&#9670;&#160;</a></span>udif_packet_serialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_packet_serialize </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>stream</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>streamlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize packet to byte stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>Output byte stream </td></tr>
    <tr><td class="paramname">streamlen</td><td>Output stream length </td></tr>
    <tr><td class="paramname">packet</td><td>Packet to serialize </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="a9657370602c20ea91725f2a50817474c" name="a9657370602c20ea91725f2a50817474c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9657370602c20ea91725f2a50817474c">&#9670;&#160;</a></span>udif_packet_set_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void udif_packet_set_time </td>
          <td>(</td>
          <td class="paramtype">udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>currtime</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set packet timestamp. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>The packet </td></tr>
    <tr><td class="paramname">currtime</td><td>Current UTC time </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1d2a438c2a1b200b51ac06fed2a107ba" name="a1d2a438c2a1b200b51ac06fed2a107ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d2a438c2a1b200b51ac06fed2a107ba">&#9670;&#160;</a></span>udif_packet_validate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_packet_validate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>expected_flag</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">packet</td><td>Packet to validate </td></tr>
    <tr><td class="paramname">expected_flag</td><td>Expected packet flag </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="a1f5a207b9ad0af85c40d2457d8d67363" name="a1f5a207b9ad0af85c40d2457d8d67363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f5a207b9ad0af85c40d2457d8d67363">&#9670;&#160;</a></span>udif_session_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void udif_session_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear session state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af1fd960e16d86de618a3a7224fbd70c5" name="af1fd960e16d86de618a3a7224fbd70c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1fd960e16d86de618a3a7224fbd70c5">&#9670;&#160;</a></span>udif_session_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_session_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>plaintext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>plntextlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt a data packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">plaintext</td><td>Output plaintext buffer </td></tr>
    <tr><td class="paramname">plaintext_len</td><td>Output plaintext length </td></tr>
    <tr><td class="paramname">packet</td><td>Encrypted packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="a40491170e4361320d4afce63b9a99d09" name="a40491170e4361320d4afce63b9a99d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40491170e4361320d4afce63b9a99d09">&#9670;&#160;</a></span>udif_session_dispose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void udif_session_dispose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispose session resources. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7b6cc4eb58f1a8f6d779e62a39462042" name="a7b6cc4eb58f1a8f6d779e62a39462042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b6cc4eb58f1a8f6d779e62a39462042">&#9670;&#160;</a></span>udif_session_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_session_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>plaintext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>plntextlen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a data packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">packet</td><td>Output encrypted packet </td></tr>
    <tr><td class="paramname">plaintext</td><td>Plaintext data </td></tr>
    <tr><td class="paramname">plaintext_len</td><td>Length of plaintext </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="ade1829c128be861719c0c32a5477e2e5" name="ade1829c128be861719c0c32a5477e2e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade1829c128be861719c0c32a5477e2e5">&#9670;&#160;</a></span>udif_session_get_statistics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_session_get_statistics </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>txseq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>rxseq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>epoch</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get session statistics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">txseq</td><td>Output TX sequence number </td></tr>
    <tr><td class="paramname">rxseq</td><td>Output RX sequence number </td></tr>
    <tr><td class="paramname">epoch</td><td>Output ratchet epoch </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="a1ab646085d69be4de25db22247f87d38" name="a1ab646085d69be4de25db22247f87d38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ab646085d69be4de25db22247f87d38">&#9670;&#160;</a></span>udif_session_handshake_confirm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_session_handshake_confirm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>resp_packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_child_certificate *</td>          <td class="paramname"><span class="paramname"><em>remote_cert</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiator confirms handshake. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">packet</td><td>Output packet with handshake confirm </td></tr>
    <tr><td class="paramname">resp_packet</td><td>Received response packet </td></tr>
    <tr><td class="paramname">remote_cert</td><td>Remote certificate (verified) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="aea32aaf8925357363447569ba14f2b9f" name="aea32aaf8925357363447569ba14f2b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea32aaf8925357363447569ba14f2b9f">&#9670;&#160;</a></span>udif_session_handshake_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_session_handshake_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>confirm_packet</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Responder finishes handshake. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">packet</td><td>Output packet with handshake finish </td></tr>
    <tr><td class="paramname">confirm_packet</td><td>Received confirm packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="abbc426e2bbd31a4d54eaf99f25f002bc" name="abbc426e2bbd31a4d54eaf99f25f002bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbc426e2bbd31a4d54eaf99f25f002bc">&#9670;&#160;</a></span>udif_session_handshake_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_session_handshake_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_child_certificate *</td>          <td class="paramname"><span class="paramname"><em>local_cert</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t</td>          <td class="paramname"><span class="paramname"><em>local_privkey</em></span>[UDIF_ASYMMETRIC_SIGNING_KEY_SIZE], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t</td>          <td class="paramname"><span class="paramname"><em>local_serial</em></span>[UDIF_CERTIFICATE_SERIAL_SIZE], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t</td>          <td class="paramname"><span class="paramname"><em>remote_serial</em></span>[UDIF_CERTIFICATE_SERIAL_SIZE], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool(*</td>          <td class="paramname"><span class="paramname"><em>rng_generate&#160;</em></span>)(uint8_t *, size_t)&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initiator starts handshake. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">packet</td><td>Output packet with handshake init message </td></tr>
    <tr><td class="paramname">local_cert</td><td>Local certificate </td></tr>
    <tr><td class="paramname">local_privkey</td><td>Local private key </td></tr>
    <tr><td class="paramname">local_serial</td><td>Local entity serial </td></tr>
    <tr><td class="paramname">remote_serial</td><td>Remote entity serial </td></tr>
    <tr><td class="paramname">rng_generate</td><td>Random number generator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="aac63643f1e1606c60c2e31972a5b5195" name="aac63643f1e1606c60c2e31972a5b5195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac63643f1e1606c60c2e31972a5b5195">&#9670;&#160;</a></span>udif_session_handshake_resp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_session_handshake_resp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>init_packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_child_certificate *</td>          <td class="paramname"><span class="paramname"><em>local_cert</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t</td>          <td class="paramname"><span class="paramname"><em>local_privkey</em></span>[UDIF_ASYMMETRIC_SIGNING_KEY_SIZE], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t</td>          <td class="paramname"><span class="paramname"><em>local_serial</em></span>[UDIF_CERTIFICATE_SERIAL_SIZE], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_child_certificate *</td>          <td class="paramname"><span class="paramname"><em>remote_cert</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool(*</td>          <td class="paramname"><span class="paramname"><em>rng_generate&#160;</em></span>)(uint8_t *, size_t)&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Responder handles handshake init. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">packet</td><td>Output packet with handshake response </td></tr>
    <tr><td class="paramname">init_packet</td><td>Received init packet </td></tr>
    <tr><td class="paramname">local_cert</td><td>Local certificate </td></tr>
    <tr><td class="paramname">local_privkey</td><td>Local private key </td></tr>
    <tr><td class="paramname">local_serial</td><td>Local entity serial </td></tr>
    <tr><td class="paramname">remote_cert</td><td>Remote certificate (verified) </td></tr>
    <tr><td class="paramname">rng_generate</td><td>Random number generator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="a98fd7badff9988dff550464f3bc2f8ee" name="a98fd7badff9988dff550464f3bc2f8ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98fd7badff9988dff550464f3bc2f8ee">&#9670;&#160;</a></span>udif_session_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void udif_session_initialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a session state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state to initialize </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a45ecaa01d1d37acb9719813503393fb7" name="a45ecaa01d1d37acb9719813503393fb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45ecaa01d1d37acb9719813503393fb7">&#9670;&#160;</a></span>udif_session_is_established()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool udif_session_is_established </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if session is established. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if session is established </dd></dl>

</div>
</div>
<a id="a94dc1f6cf651af7a7f70dde921d8d4ba" name="a94dc1f6cf651af7a7f70dde921d8d4ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94dc1f6cf651af7a7f70dde921d8d4ba">&#9670;&#160;</a></span>udif_session_needs_ratchet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool udif_session_needs_ratchet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>currtime</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if ratchet is needed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">current_time</td><td>Current UTC time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if ratchet interval elapsed </dd></dl>

</div>
</div>
<a id="ac16ff01596721265c74015fcef49708a" name="ac16ff01596721265c74015fcef49708a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac16ff01596721265c74015fcef49708a">&#9670;&#160;</a></span>udif_session_ratchet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_session_ratchet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__session__state.html">udif_session_state</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packetout</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const udif_network_packet *</td>          <td class="paramname"><span class="paramname"><em>packetin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool(*</td>          <td class="paramname"><span class="paramname"><em>rng_generate&#160;</em></span>)(uint8_t *, size_t)&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform asymmetric ratchet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session state </td></tr>
    <tr><td class="paramname">packetout</td><td>Output packet with ratchet message </td></tr>
    <tr><td class="paramname">packetin</td><td>Input packet with ratchet request </td></tr>
    <tr><td class="paramname">rng_generate</td><td>Random number generator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_26cd59994238c2dc562ea2212e9609f3.html">UDIF</a></li><li class="navelem"><a href="dir_fc9d8b104a29d847c89dcbcd72c1f139.html">Saved</a></li><li class="navelem"><a href="transport_8h.html">transport.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
