<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UDIF: Universal Digital Identification Framework: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/UDIF/UDIF/storage.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="udif_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">UDIF: Universal Digital Identification Framework<span id="projectnumber">&#160;1.0.0.0a (A1)</span>
   </div>
   <div id="projectbrief">A quantum-secure cryptographic identification</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('storage_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">storage.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>UDIF file-based storage backend for MCEL integration.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="udifcommon_8h_source.html">udifcommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="udif_8h_source.html">udif.h</a>&quot;</code><br />
<code>#include &quot;fileutils.h&quot;</code><br />
</div>
<p><a href="storage_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:udif_5Ffile_5Fhandle" id="r_udif_5Ffile_5Fhandle"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structudif__file__handle.html">udif_file_handle</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cached file handle with metadata.  <a href="structudif__file__handle.html#details">More...</a><br /></td></tr>
<tr class="memitem:udif_5Fstorage_5Fcontext" id="r_udif_5Fstorage_5Fcontext"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structudif__storage__context.html">udif_storage_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">File-based storage context for MCEL integration.  <a href="structudif__storage__context.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a190627f4c3ba4d6be149676478322317" id="r_a190627f4c3ba4d6be149676478322317"><td class="memItemLeft" align="right" valign="top"><a id="a190627f4c3ba4d6be149676478322317" name="a190627f4c3ba4d6be149676478322317"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>UDIF_STORAGE_MAX_PATH</b>&#160;&#160;&#160;512U</td></tr>
<tr class="memdesc:a190627f4c3ba4d6be149676478322317"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum file path length. <br /></td></tr>
<tr class="memitem:afaf65d302cec51824adfae6c892336c2" id="r_afaf65d302cec51824adfae6c892336c2"><td class="memItemLeft" align="right" valign="top"><a id="afaf65d302cec51824adfae6c892336c2" name="afaf65d302cec51824adfae6c892336c2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>UDIF_STORAGE_MAX_HANDLES</b>&#160;&#160;&#160;16U</td></tr>
<tr class="memdesc:afaf65d302cec51824adfae6c892336c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of cached file handles. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aba534d6729ee8ffe291eb724066e6af8" id="r_aba534d6729ee8ffe291eb724066e6af8"><td class="memItemLeft" align="right" valign="top"><a id="aba534d6729ee8ffe291eb724066e6af8" name="aba534d6729ee8ffe291eb724066e6af8"></a>
typedef enum <a class="el" href="#a83647cd94259d5cd64e5aeebe3360861">udif_ledger_type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>udif_ledger_type</b></td></tr>
<tr class="memitem:a3d862e3d31a26519c7c897420e13b0b6" id="r_a3d862e3d31a26519c7c897420e13b0b6"><td class="memItemLeft" align="right" valign="top"><a id="a3d862e3d31a26519c7c897420e13b0b6" name="a3d862e3d31a26519c7c897420e13b0b6"></a>
typedef struct udif_file_handle&#160;</td><td class="memItemRight" valign="bottom"><b>udif_file_handle</b></td></tr>
<tr class="memitem:aef35c3e1c8ff3e0ae6b449230f65ba09" id="r_aef35c3e1c8ff3e0ae6b449230f65ba09"><td class="memItemLeft" align="right" valign="top"><a id="aef35c3e1c8ff3e0ae6b449230f65ba09" name="aef35c3e1c8ff3e0ae6b449230f65ba09"></a>
typedef struct udif_storage_context&#160;</td><td class="memItemRight" valign="bottom"><b>udif_storage_context</b></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-enum-members" class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a83647cd94259d5cd64e5aeebe3360861" id="r_a83647cd94259d5cd64e5aeebe3360861"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83647cd94259d5cd64e5aeebe3360861">udif_ledger_type</a> { <a class="el" href="#a83647cd94259d5cd64e5aeebe3360861a4fccc3b1d5f40eb3e20e908a98ab09ee">UDIF_LEDGER_MEMBERSHIP</a> = 0U
, <a class="el" href="#a83647cd94259d5cd64e5aeebe3360861aa9ec24771117be01892164ea1f5b06c9">UDIF_LEDGER_TRANSACTION</a> = 1U
, <a class="el" href="#a83647cd94259d5cd64e5aeebe3360861ae5aaf62db61f00143521dc455b659c21">UDIF_LEDGER_REGISTRY</a> = 2U
 }</td></tr>
<tr class="memdesc:a83647cd94259d5cd64e5aeebe3360861"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ledger namespace identifiers.  <a href="#a83647cd94259d5cd64e5aeebe3360861">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abba718f102d7d6be452d062a921fec1c" id="r_abba718f102d7d6be452d062a921fec1c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abba718f102d7d6be452d062a921fec1c">udif_storage_initialize</a> (<a class="el" href="structudif__storage__context.html">udif_storage_context</a> *ctx, const char *basepath)</td></tr>
<tr class="memdesc:abba718f102d7d6be452d062a921fec1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize storage context.  <br /></td></tr>
<tr class="memitem:a180b9de4ddc6ca1d5015329f76c0e627" id="r_a180b9de4ddc6ca1d5015329f76c0e627"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a180b9de4ddc6ca1d5015329f76c0e627">udif_storage_set_ledger</a> (<a class="el" href="structudif__storage__context.html">udif_storage_context</a> *ctx, <a class="el" href="#a83647cd94259d5cd64e5aeebe3360861">udif_ledger_type</a> ledgertype)</td></tr>
<tr class="memdesc:a180b9de4ddc6ca1d5015329f76c0e627"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set active ledger namespace.  <br /></td></tr>
<tr class="memitem:a55018d902800b65fae234366bf93ed26" id="r_a55018d902800b65fae234366bf93ed26"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a55018d902800b65fae234366bf93ed26">udif_storage_get_callbacks</a> (<a class="el" href="structudif__storage__context.html">udif_storage_context</a> *ctx, void *callbacks)</td></tr>
<tr class="memdesc:a55018d902800b65fae234366bf93ed26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get MCEL store callbacks for this context.  <br /></td></tr>
<tr class="memitem:a506ec1d2a736c93b182910c5cb94c988" id="r_a506ec1d2a736c93b182910c5cb94c988"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a506ec1d2a736c93b182910c5cb94c988">udif_storage_dispose</a> (<a class="el" href="structudif__storage__context.html">udif_storage_context</a> *ctx)</td></tr>
<tr class="memdesc:a506ec1d2a736c93b182910c5cb94c988"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispose storage context.  <br /></td></tr>
<tr class="memitem:a9cfadd73ccbb1962dd0698e97b197501" id="r_a9cfadd73ccbb1962dd0698e97b197501"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9cfadd73ccbb1962dd0698e97b197501">udif_storage_write</a> (void *context, const uint8_t *loc, size_t loclen, const uint8_t *data, size_t datalen)</td></tr>
<tr class="memdesc:a9cfadd73ccbb1962dd0698e97b197501"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write complete object to storage.  <br /></td></tr>
<tr class="memitem:aedba25fbe1ff5c4d58c11698bb117477" id="r_aedba25fbe1ff5c4d58c11698bb117477"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aedba25fbe1ff5c4d58c11698bb117477">udif_storage_read</a> (void *context, const uint8_t *loc, size_t loclen, uint8_t *data, size_t datalen, size_t *outread)</td></tr>
<tr class="memdesc:aedba25fbe1ff5c4d58c11698bb117477"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read complete object from storage.  <br /></td></tr>
<tr class="memitem:a9e9de7a0e7a08618e3f13ddae09db633" id="r_a9e9de7a0e7a08618e3f13ddae09db633"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e9de7a0e7a08618e3f13ddae09db633">udif_storage_append</a> (void *context, const uint8_t *loc, size_t loclen, const uint8_t *data, size_t datalen, uint64_t *outpos)</td></tr>
<tr class="memdesc:a9e9de7a0e7a08618e3f13ddae09db633"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append data to append-only object.  <br /></td></tr>
<tr class="memitem:acc275a98adf9c8fbed0b14395ef999d6" id="r_acc275a98adf9c8fbed0b14395ef999d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc275a98adf9c8fbed0b14395ef999d6">udif_storage_size</a> (void *context, const uint8_t *loc, size_t loclen, uint64_t *outlen)</td></tr>
<tr class="memdesc:acc275a98adf9c8fbed0b14395ef999d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get object size.  <br /></td></tr>
<tr class="memitem:a48d74d136578a05dcacef20c306b5854" id="r_a48d74d136578a05dcacef20c306b5854"><td class="memItemLeft" align="right" valign="top"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48d74d136578a05dcacef20c306b5854">udif_storage_flush</a> (void *context, const uint8_t *loc, size_t loclen)</td></tr>
<tr class="memdesc:a48d74d136578a05dcacef20c306b5854"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush buffered data.  <br /></td></tr>
<tr class="memitem:a82a09103e0160c3749067adb5f7ed4d2" id="r_a82a09103e0160c3749067adb5f7ed4d2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82a09103e0160c3749067adb5f7ed4d2">udif_storage_resolve_path</a> (const <a class="el" href="structudif__storage__context.html">udif_storage_context</a> *ctx, const uint8_t *loc, size_t loclen, char *outpath, size_t outpathlen)</td></tr>
<tr class="memdesc:a82a09103e0160c3749067adb5f7ed4d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resolve logical location to file path.  <br /></td></tr>
<tr class="memitem:a9e451b1ea40546804209625fa054b29c" id="r_a9e451b1ea40546804209625fa054b29c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e451b1ea40546804209625fa054b29c">udif_storage_mkdir_recursive</a> (const char *path)</td></tr>
<tr class="memdesc:a9e451b1ea40546804209625fa054b29c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create directory recursively.  <br /></td></tr>
<tr class="memitem:af221e83e94b8a9e116fc21d55949ec08" id="r_af221e83e94b8a9e116fc21d55949ec08"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af221e83e94b8a9e116fc21d55949ec08">udif_storage_get_handle</a> (<a class="el" href="structudif__storage__context.html">udif_storage_context</a> *ctx, const char *path, qsc_fileutils_mode mode, FILE **outfp)</td></tr>
<tr class="memdesc:af221e83e94b8a9e116fc21d55949ec08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get or open cached file handle.  <br /></td></tr>
<tr class="memitem:a53762594eae59bd0c44f623e643ffe08" id="r_a53762594eae59bd0c44f623e643ffe08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a53762594eae59bd0c44f623e643ffe08">udif_storage_evict_handle</a> (<a class="el" href="structudif__storage__context.html">udif_storage_context</a> *ctx, const char *path)</td></tr>
<tr class="memdesc:a53762594eae59bd0c44f623e643ffe08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close and evict a cached handle.  <br /></td></tr>
<tr class="memitem:ae32f0b82d565d339d5ea53797681f84a" id="r_ae32f0b82d565d339d5ea53797681f84a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae32f0b82d565d339d5ea53797681f84a">udif_storage_close_all_handles</a> (<a class="el" href="structudif__storage__context.html">udif_storage_context</a> *ctx)</td></tr>
<tr class="memdesc:ae32f0b82d565d339d5ea53797681f84a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close all cached handles.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>UDIF file-based storage backend for MCEL integration. </p>
<p>This module implements the storage backend required by MCEL's <a class="el" href="structmcel__store__callbacks.html">mcel_store_callbacks</a> interface. It provides file-based persistence for ledger records, blocks, checkpoints, and indexes.</p>
<p>The storage backend manages three separate ledger namespaces:</p><ul>
<li>Membership ledger (certificates, capabilities, treaties)</li>
<li>Transaction ledger (object operations, queries)</li>
<li>Registry ledger (object ownership records)</li>
</ul>
<p>Storage Layout: &lt;base_path&gt;/ membership/ mcel/records - Append-only membership events mcel/blocks - Sealed membership blocks mcel/checkpoints - Signed membership checkpoints mcel/head - Current checkpoint head transaction/ mcel/records - Append-only transaction events mcel/blocks - Sealed transaction blocks mcel/checkpoints - Signed transaction checkpoints mcel/head - Current checkpoint head registry/ mcel/records - Append-only registry events mcel/blocks - Sealed registry blocks mcel/checkpoints - Signed registry checkpoints mcel/head - Current checkpoint head </p>
</div><a name="doc-enum-members" id="doc-enum-members"></a><h2 id="header-doc-enum-members" class="groupheader">Enumeration Type Documentation</h2>
<a id="a83647cd94259d5cd64e5aeebe3360861" name="a83647cd94259d5cd64e5aeebe3360861"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83647cd94259d5cd64e5aeebe3360861">&#9670;&#160;</a></span>udif_ledger_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a83647cd94259d5cd64e5aeebe3360861">udif_ledger_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ledger namespace identifiers. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a83647cd94259d5cd64e5aeebe3360861a4fccc3b1d5f40eb3e20e908a98ab09ee" name="a83647cd94259d5cd64e5aeebe3360861a4fccc3b1d5f40eb3e20e908a98ab09ee"></a>UDIF_LEDGER_MEMBERSHIP&#160;</td><td class="fielddoc"><p>Membership ledger namespace </p>
</td></tr>
<tr><td class="fieldname"><a id="a83647cd94259d5cd64e5aeebe3360861aa9ec24771117be01892164ea1f5b06c9" name="a83647cd94259d5cd64e5aeebe3360861aa9ec24771117be01892164ea1f5b06c9"></a>UDIF_LEDGER_TRANSACTION&#160;</td><td class="fielddoc"><p>Transaction ledger namespace </p>
</td></tr>
<tr><td class="fieldname"><a id="a83647cd94259d5cd64e5aeebe3360861ae5aaf62db61f00143521dc455b659c21" name="a83647cd94259d5cd64e5aeebe3360861ae5aaf62db61f00143521dc455b659c21"></a>UDIF_LEDGER_REGISTRY&#160;</td><td class="fielddoc"><p>Registry ledger namespace </p>
</td></tr>
</table>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a9e9de7a0e7a08618e3f13ddae09db633" name="a9e9de7a0e7a08618e3f13ddae09db633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e9de7a0e7a08618e3f13ddae09db633">&#9670;&#160;</a></span>udif_storage_append()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool udif_storage_append </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>loclen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>datalen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>outpos</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Append data to append-only object. </p>
<p>Appends data to the end of an append-only file and returns the position. Creates the file if it doesn't exist.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>The storage context </td></tr>
    <tr><td class="paramname">loc</td><td>[const] The logical location identifier </td></tr>
    <tr><td class="paramname">loclen</td><td>The location identifier length </td></tr>
    <tr><td class="paramname">data</td><td>[const] The data to append </td></tr>
    <tr><td class="paramname">datalen</td><td>The data length </td></tr>
    <tr><td class="paramname">outpos</td><td>Pointer to receive append position (can be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success </dd></dl>

</div>
</div>
<a id="ae32f0b82d565d339d5ea53797681f84a" name="ae32f0b82d565d339d5ea53797681f84a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae32f0b82d565d339d5ea53797681f84a">&#9670;&#160;</a></span>udif_storage_close_all_handles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void udif_storage_close_all_handles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__storage__context.html">udif_storage_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close all cached handles. </p>
<p>Closes all cached file handles (used during dispose).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The storage context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a506ec1d2a736c93b182910c5cb94c988" name="a506ec1d2a736c93b182910c5cb94c988"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a506ec1d2a736c93b182910c5cb94c988">&#9670;&#160;</a></span>udif_storage_dispose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void udif_storage_dispose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__storage__context.html">udif_storage_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispose storage context. </p>
<p>Closes all cached file handles and frees resources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The storage context to dispose </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a53762594eae59bd0c44f623e643ffe08" name="a53762594eae59bd0c44f623e643ffe08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53762594eae59bd0c44f623e643ffe08">&#9670;&#160;</a></span>udif_storage_evict_handle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void udif_storage_evict_handle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__storage__context.html">udif_storage_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close and evict a cached handle. </p>
<p>Closes a file handle and removes it from the cache.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The storage context </td></tr>
    <tr><td class="paramname">path</td><td>[const] The file path to evict </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a48d74d136578a05dcacef20c306b5854" name="a48d74d136578a05dcacef20c306b5854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48d74d136578a05dcacef20c306b5854">&#9670;&#160;</a></span>udif_storage_flush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool udif_storage_flush </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>loclen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flush buffered data. </p>
<p>Forces all buffered data for a logical location to be written to disk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>The storage context </td></tr>
    <tr><td class="paramname">loc</td><td>[const] The logical location identifier </td></tr>
    <tr><td class="paramname">loclen</td><td>The location identifier length</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success </dd></dl>

</div>
</div>
<a id="a55018d902800b65fae234366bf93ed26" name="a55018d902800b65fae234366bf93ed26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55018d902800b65fae234366bf93ed26">&#9670;&#160;</a></span>udif_storage_get_callbacks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void udif_storage_get_callbacks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__storage__context.html">udif_storage_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>callbacks</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get MCEL store callbacks for this context. </p>
<p>Returns a populated <a class="el" href="structmcel__store__callbacks.html">mcel_store_callbacks</a> structure that can be passed to MCEL initialization functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The storage context </td></tr>
    <tr><td class="paramname">callbacks</td><td>The output callbacks structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af221e83e94b8a9e116fc21d55949ec08" name="af221e83e94b8a9e116fc21d55949ec08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af221e83e94b8a9e116fc21d55949ec08">&#9670;&#160;</a></span>udif_storage_get_handle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool udif_storage_get_handle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__storage__context.html">udif_storage_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qsc_fileutils_mode</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE **</td>          <td class="paramname"><span class="paramname"><em>outfp</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get or open cached file handle. </p>
<p>Returns a cached file handle for a path, opening it if necessary. Uses LRU eviction if cache is full.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The storage context </td></tr>
    <tr><td class="paramname">path</td><td>[const] The file path </td></tr>
    <tr><td class="paramname">mode</td><td>[const] The open mode string </td></tr>
    <tr><td class="paramname">outfp</td><td>Pointer to receive FILE*</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success </dd></dl>

</div>
</div>
<a id="abba718f102d7d6be452d062a921fec1c" name="abba718f102d7d6be452d062a921fec1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abba718f102d7d6be452d062a921fec1c">&#9670;&#160;</a></span>udif_storage_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> <a class="el" href="udif_8h.html#ac569e8bb8bc866905a1be276a6c108cf">udif_errors</a> udif_storage_initialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__storage__context.html">udif_storage_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>basepath</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize storage context. </p>
<p>Creates the base directory structure and initializes the storage context. This must be called before any storage operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The storage context to initialize </td></tr>
    <tr><td class="paramname">basepath</td><td>[const] The base directory path (e.g., "/var/udif/ledgers/entity_serial")</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns udif_error_none on success </dd></dl>

</div>
</div>
<a id="a9e451b1ea40546804209625fa054b29c" name="a9e451b1ea40546804209625fa054b29c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e451b1ea40546804209625fa054b29c">&#9670;&#160;</a></span>udif_storage_mkdir_recursive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool udif_storage_mkdir_recursive </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create directory recursively. </p>
<p>Creates all parent directories needed for a path.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>[const] The directory path</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success </dd></dl>

</div>
</div>
<a id="aedba25fbe1ff5c4d58c11698bb117477" name="aedba25fbe1ff5c4d58c11698bb117477"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedba25fbe1ff5c4d58c11698bb117477">&#9670;&#160;</a></span>udif_storage_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool udif_storage_read </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>loclen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>datalen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>outread</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read complete object from storage. </p>
<p>Reads the entire content at a logical location into a buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>The storage context </td></tr>
    <tr><td class="paramname">loc</td><td>[const] The logical location identifier </td></tr>
    <tr><td class="paramname">loclen</td><td>The location identifier length </td></tr>
    <tr><td class="paramname">data</td><td>The output buffer </td></tr>
    <tr><td class="paramname">datalen</td><td>The output buffer length </td></tr>
    <tr><td class="paramname">outread</td><td>Pointer to receive bytes read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success </dd></dl>

</div>
</div>
<a id="a82a09103e0160c3749067adb5f7ed4d2" name="a82a09103e0160c3749067adb5f7ed4d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82a09103e0160c3749067adb5f7ed4d2">&#9670;&#160;</a></span>udif_storage_resolve_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool udif_storage_resolve_path </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structudif__storage__context.html">udif_storage_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>loclen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>outpath</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>outpathlen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resolve logical location to file path. </p>
<p>Converts an MCEL logical location to a full file system path based on the current ledger namespace.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>[const] The storage context </td></tr>
    <tr><td class="paramname">loc</td><td>[const] The logical location </td></tr>
    <tr><td class="paramname">loclen</td><td>The location length </td></tr>
    <tr><td class="paramname">outpath</td><td>The output path buffer </td></tr>
    <tr><td class="paramname">outpathlen</td><td>The output path buffer length</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success </dd></dl>

</div>
</div>
<a id="a180b9de4ddc6ca1d5015329f76c0e627" name="a180b9de4ddc6ca1d5015329f76c0e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a180b9de4ddc6ca1d5015329f76c0e627">&#9670;&#160;</a></span>udif_storage_set_ledger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> void udif_storage_set_ledger </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structudif__storage__context.html">udif_storage_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a83647cd94259d5cd64e5aeebe3360861">udif_ledger_type</a></td>          <td class="paramname"><span class="paramname"><em>ledgertype</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set active ledger namespace. </p>
<p>Switches the storage context to operate on a specific ledger namespace. All subsequent storage operations will use this namespace until changed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The storage context </td></tr>
    <tr><td class="paramname">ledgertype</td><td>The ledger namespace to activate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acc275a98adf9c8fbed0b14395ef999d6" name="acc275a98adf9c8fbed0b14395ef999d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc275a98adf9c8fbed0b14395ef999d6">&#9670;&#160;</a></span>udif_storage_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool udif_storage_size </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>loclen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>outlen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get object size. </p>
<p>Returns the size in bytes of an object at a logical location.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>The storage context </td></tr>
    <tr><td class="paramname">loc</td><td>[const] The logical location identifier </td></tr>
    <tr><td class="paramname">loclen</td><td>The location identifier length </td></tr>
    <tr><td class="paramname">outlen</td><td>Pointer to receive size in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success </dd></dl>

</div>
</div>
<a id="a9cfadd73ccbb1962dd0698e97b197501" name="a9cfadd73ccbb1962dd0698e97b197501"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cfadd73ccbb1962dd0698e97b197501">&#9670;&#160;</a></span>udif_storage_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="udifcommon_8h.html#a7133d97836e4d6a3856499913bf58812">UDIF_EXPORT_API</a> bool udif_storage_write </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>loclen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>datalen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write complete object to storage. </p>
<p>Overwrites the entire content at a logical location. Creates parent directories if necessary.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>The storage context </td></tr>
    <tr><td class="paramname">loc</td><td>[const] The logical location identifier </td></tr>
    <tr><td class="paramname">loclen</td><td>The location identifier length </td></tr>
    <tr><td class="paramname">data</td><td>[const] The data to write </td></tr>
    <tr><td class="paramname">datalen</td><td>The data length</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true on success </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_26cd59994238c2dc562ea2212e9609f3.html">UDIF</a></li><li class="navelem"><a href="storage_8h.html">storage.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
